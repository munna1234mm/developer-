<?php
$message = "";
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $project = preg_replace('/[^A-Za-z0-9_\-]/', '_', $_POST['project']);
    $id = time() . rand(100,999); // unique ID
    $folder = "posts";
    if (!is_dir($folder)) mkdir($folder);

    $filename = "$folder/$project-$id.html";

    $content = "<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<title>$project</title>
<style>
body{font-family:Arial,sans-serif;padding:20px;background:#f5f5f5;}
pre{background:#333;color:#f5f5f5;padding:15px;border-radius:5px;overflow:auto;}
</style>
</head>
<body>
<h2>$project</h2>
<pre>";

    // File upload
    if (!empty($_FILES['file']['name'])) {
        $file_content = file_get_contents($_FILES['file']['tmp_name']);
        $content .= htmlspecialchars($file_content);
    }

    // Pasted code
    if (!empty($_POST['code'])) {
        $content .= htmlspecialchars($_POST['code']);
    }

    $content .= "</pre></body></html>";

    file_put_contents($filename, $content);

    $link = $_SERVER['REQUEST_SCHEME'] . "://" . $_SERVER['HTTP_HOST'] . dirname($_SERVER['PHP_SELF']) . "/" . $filename;
    $message = "âœ… Hosted! Shareable link: <a href='$link' target='_blank'>$link</a>";
}
?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Code Hosting Web</title>
<style>
body{font-family:Arial,sans-serif;background:#1e1e1e;color:#f5f5f5;margin:0;padding:0;}
header{background:#0078d7;padding:15px;text-align:center;font-size:22px;font-weight:bold;}
.container{max-width:800px;margin:30px auto;background:#2d2d2d;padding:20px;border-radius:10px;box-shadow:0 0 10px #000;}
input,textarea,button{width:100%;padding:10px;margin:8px 0;border-radius:5px;border:none;font-size:16px;}
input,textarea{background:#1a1a1a;color:#f5f5f5;}
button{background:#0078d7;color:#fff;cursor:pointer;transition:0.3s;}
button:hover{background:#005a9e;}
.message{background:#333;padding:10px;border-left:4px solid #0078d7;margin-top:15px;}
</style>
</head>
<body>
<header>ðŸš€ Code Hosting Web</header>
<div class="container">
<h2>Upload Project or Paste Code</h2>
<form method="post" enctype="multipart/form-data">
<label>Project/Doom Name:</label>
<input type="text" name="project" required placeholder="Enter project name">
<label>Upload File:</label>
<input type="file" name="file">
<label>Or Paste Your Code:</label>
<textarea name="code" rows="10" placeholder="Paste your code here..."></textarea>
<button type="submit">Host Code</button>
</form>
<?php if($message!==""){ echo "<div class='message'>$message</div>"; } ?>
</div>
</body>
</html>
